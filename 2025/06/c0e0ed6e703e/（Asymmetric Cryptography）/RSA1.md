---
title: RSA1
date: '2025-6-14 22:00'
categories:
  - Crypto
  - 非对称加密（Asymmetric Cryptography）
---
p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229 
q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469 
dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929 
dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041 
c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852

==dp,dq  是`d`模`p-1`和`q-1`的模逆元（在RSA中，它们通常用于快速解密，因为使用它们可以避免计算`d`，这是一个大数。==
```
import gmpy2
from Crypto.Util.number import long_to_bytes   #将长整数转化为字节字符串
 
p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229
q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469
dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929
dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041
c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852
 
I = gmpy2.invert(q, p) 
 # 计算了q模p的模逆元。在数学上，这意味着I是一个整数，使得q * I mod p = 1。注意，这里的I并不是中国剩余定理中常用的h（h是p模q的模逆元），但在这个上下文中，我们只需要I
 
mp = pow(c, dp, p)   #使用模幂运算，计算c的dp次方模p的结果。
mq = pow(c, dq, q)   #使用模幂运算，计算c的dq次方模q的结果。
 
m = (((mp-mq) * I) % p) * q + mq      #CRT的一个变种，用于从mp和mq中恢复明文m
 
print(long_to_bytes(m))    #解密后的整数m转换为字节字符串并输出 
```
 b'noxCTF{W31c0m3_70_Ch1n470wn}'→flag{W31c0m3_70_Ch1n470wn}












